$(function () {
	sliderInit()
	replaceHash()
	lenisSetup()
})

function preLoader() {
	const tl = gsap.timeline({
		duration: 0.1
	});
	tl.to('.preLoader.black > img', {
		delay: 1,
		y: 50,
		autoAlpha: 0
	})
		.to('.preLoader.black', {
			yPercent: -100
		})
		.to('.preLoader.white', {
			yPercent: -100
		})
		.to('.preLoader', {
			css: {
				display: 'none'
			}
		})
		.from('.navbar-brand > img', {
			x: -50,
			autoAlpha: 0
		})
		.from(
			'.navbar-nav > li, .form-inline a', {
			autoAlpha: 0,
			x: 100,
			stagger: 0.05
		},
			'>-0.5'
		)
		.from('.slideOne', {
			autoAlpha: 0,
			yPercent: 100,
			stagger: 0.05
		})
		.from(
			'.bg-image', {
			autoAlpha: 0
		},
			'<-0.25'
		);
}

function lenisSetup() {
	const lenis = new Lenis({
		duration: 1.5,
		easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
		smooth: true,
		mouseMultiplier: 1,
	});

	function raf(time) {
		lenis.raf(time);
		requestAnimationFrame(raf);
	}
	requestAnimationFrame(raf);
	document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
		anchor.addEventListener("click", function (e) {
			e.preventDefault();
			lenis.scrollTo(this.getAttribute("href"));
		});
	});
	lenis.scrollTo("top");
}

function replaceHash() {
	document.querySelectorAll("a").forEach((a) => {
		let href = a.getAttribute("href");
		a.href = href ?
			href.startsWith("#") && href.endsWith("#") ?
				href.replace("#", "javascript:void(0)") :
				href :
			"javascript:void(0)";
	});
}
document.addEventListener('DOMContentLoaded', function () {
	const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
	const dropdownMenus = document.querySelectorAll('.dropdown-menu');
	const dropdownIcons = document.querySelectorAll('.fa-chevron-down');

	dropdownToggles.forEach((toggle, index) => {
		const menu = dropdownMenus[index];
		const icon = dropdownIcons[index];

		toggle.addEventListener('click', function (e) {
			e.preventDefault();
			if (menu.classList.contains('show')) {
				menu.classList.remove('show');
				icon.style.transform = 'rotate(0deg)';
			} else {
				dropdownMenus.forEach(m => m.classList.remove('show'));
				dropdownIcons.forEach(i => i.style.transform = 'rotate(0deg)');

				menu.classList.add('show');
				icon.style.transform = 'rotate(180deg)';
			}
		});
	});
});

let isSticky = false;

window.addEventListener('scroll', function () {
	const header = document.querySelector('.main-header');
	const logo = document.querySelector('.main-header .logo');
	const scrollY = window.scrollY;
	const screenWidth = window.innerWidth;

	if (screenWidth >= 992) {
		if (scrollY > 50 && !isSticky) {
			header.classList.add('sticky-header');
			logo.src = 'images/logo-blue.png';
			isSticky = true;
		} else if (scrollY <= 50 && isSticky) {
			header.classList.remove('sticky-header');
			logo.src = 'images/logo-white.png';
			isSticky = false;
		}
	} else {
		if (isSticky) {
			header.classList.remove('sticky-header');
			logo.src = 'images/logo-white.png';
			isSticky = false;
		}
	}
});

function sliderInit() {
	const isDesktop = window.innerWidth >= 992;

	const swiperOptions = {
		loop: true,
		speed: 1000,
		parallax: isDesktop, 
		autoplay: {
			delay: 3500,
			disableOnInteraction: false,
		},
		autoplay: false,
		grabCursor: false,
		pagination: {
			el: '.swiper-pagination',
			clickable: true
		},
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev'
		}
	};

	var bannerSlider = new Swiper('.hero_slider', swiperOptions);

	var pageSections = document.querySelectorAll('.hero_main');
	pageSections.forEach(function (pageSection) {
		var backgroundUrl = pageSection.getAttribute('data-background');
		if (backgroundUrl) {
			pageSection.style.backgroundImage = 'url(' + backgroundUrl + ')';
		}
	});


	var logoSlider = new Swiper('.logoSlider', {
		loop: true,
		autoplay: true,
		slidesPerView: 1,
		spaceBetween: 10,
		centeredSlides: true,
		roundLengths: true,
		breakpoints: {
			1199: {
				slidesPerView: 5,
				spaceBetween: 10
			},
			768: {
				slidesPerView: 4,
				spaceBetween: 10
			},
			576: {
				slidesPerView: 3,
				spaceBetween: 10
			},
			375: {
				slidesPerView: 2,
				spaceBetween: 10
			}
		},
	});

	var industrySlider = new Swiper('.industrySlider', {
		loop: true,
		slidesPerView: 4,
		spaceBetween: 20,
		breakpoints: {
			1024: {
				slidesPerView: 4,
				spaceBetween: 20
			},
			768: {
				slidesPerView: 1,
				spaceBetween: 20
			},
			640: {
				slidesPerView: 1,
				spaceBetween: 10
			},
			576: {
				slidesPerView: 1,
				spaceBetween: 10
			},
			375: {
				slidesPerView: 1,
				spaceBetween: 10
			}
		},
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev'
		},
		scrollbar: {
			el: '.swiper-scrollbar'
		}
	});
	$('.product_slider').slick({
		slidesToShow: 3,
		slidesToScroll: 1,
		autoplay: true,
		autoplaySpeed: 3000,
		dots: true,
		arrows: false,
		responsive: [
			{
				breakpoint: 1199,
				settings: {
					slidesToShow: 3,
					slidesToScroll: 1
				}
			},
			{
				breakpoint: 768,
				settings: {
					slidesToShow: 2,
					slidesToScroll: 1
				}
			},
			{
				breakpoint: 576,
				settings: {
					slidesToShow: 1,
					slidesToScroll: 1
				}
			}
		]
	});
	$('.testimonial_slider').slick({
		slidesToShow: 3,
		slidesToScroll: 1,
		autoplay: true,
		autoplaySpeed: 3000,
		dots: true,
		arrows: false,
		responsive: [
			{
				breakpoint: 1199,
				settings: {
					slidesToShow: 3,
					slidesToScroll: 1
				}
			},
			{
				breakpoint: 768,
				settings: {
					slidesToShow: 2,
					slidesToScroll: 1
				}
			},
			{
				breakpoint: 576,
				settings: {
					slidesToShow: 1,
					slidesToScroll: 1
				}
			}
		]
	});
}
